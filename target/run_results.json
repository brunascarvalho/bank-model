{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2024-04-24T22:59:18.478883Z", "invocation_id": "23c7bfb9-7263-487d-b904-df67767131cc", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.643841Z", "completed_at": "2024-04-24T22:59:17.666839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.671837Z", "completed_at": "2024-04-24T22:59:17.671837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0420079231262207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_model.bank_info_bronze", "compiled": true, "compiled_code": "\nwith source_bank_info as (\n    select * from \"ada\".\"public\".\"bank_info\"\n),\n\nfinal as (\n          select \"ID\" as \"id\"\n           ,\"Customer_ID\" as \"customer_id\"\n           ,\"Month\" as \"month\"\n           ,\"Name\" as \"name\"\n           ,\"Age\" as \"age\"\n           ,\"SSN\" as \"ssn\"\n           ,\"Occupation\" as \"occupation\"\n           ,\"Annual_Income\" as \"annual_income\"\n           ,\"Monthly_Inhand_Salary\" as \"monthly_inhand_salary\"\n           ,\"Num_Bank_Accounts\" as \"num_bank_accounts\"\n           ,\"Num_Credit_Card\" as \"num_credit_card\"\n           ,\"Interest_Rate\" as \"interest_rate\"\n           ,\"Num_of_Loan\" as \"mum_of_loan\"\n           ,\"Type_of_Loan\" as \"type_of_loan\"\n           ,\"Delay_from_due_date\" as \"delay_from_due_date\"\n           ,\"Num_of_Delayed_Payment\" as \"num_of_delayed_payment\"\n           ,\"Changed_Credit_Limit\" as \"changed_credit_limit\"\n           ,\"Num_Credit_Inquiries\" as \"num_credit_inquiries\"\n           ,\"Credit_Mix\" as \"credit_mix\"\n           ,\"Outstanding_Debt\" as \"outstanding_debt\"\n           ,\"Credit_Utilization_Ratio\" as \"credit_utilization_ratio\"\n           ,\"Credit_History_Age\" as \"credit_history_age\"\n           ,\"Payment_of_Min_Amount\" as \"payment_of_min_amount\"\n           ,\"Total_EMI_per_month\" as \"total_emi_per_month\"\n           ,\"Amount_invested_monthly\" as \"amount_invested_monthly\"\n           ,\"Payment_Behaviour\" as \"payment_behaviour\"\n           ,\"Monthly_Balance\" as \"monthly_balance\"\n     from source_bank_info\n)\n\nselect * from final", "relation_name": "\"ada\".\"public\".\"bank_info_bronze\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.684839Z", "completed_at": "2024-04-24T22:59:17.697839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.701838Z", "completed_at": "2024-04-24T22:59:17.701838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02300286293029785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_model.bank_info_gold_last_id", "compiled": true, "compiled_code": "\nwith source_ibm_prices as (\n    select * from \"ada\".\"public\".\"bank_info_silver\"\n),\n\nlast_id as (\n    select customer_id, \n           max(id) as max_id\n    from source_ibm_prices\n    group by customer_id\n),\n\nfinal as (\n    select source_ibm_prices.customer_id\n           ,credit_history_age_years as last_credit_history_age_years\n           ,credit_history_months as last_credit_history_months\n    from source_ibm_prices, last_id\n    where source_ibm_prices.id = last_id.max_id\n)\n\nselect * from final", "relation_name": "\"ada\".\"public\".\"bank_info_gold_last_id\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.714839Z", "completed_at": "2024-04-24T22:59:17.736840Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.742838Z", "completed_at": "2024-04-24T22:59:17.742838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03699636459350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_model.bank_info_gold_res_avg", "compiled": true, "compiled_code": "\nwith source_ibm_prices as (\n    select * from \"ada\".\"public\".\"bank_info_silver\"\n),\n\nfinal as (\n    select  source_ibm_prices.customer_id\n           ,avg(num_of_delayed_payment) as mean_num_of_delayed_payment\n           ,avg(num_credit_inquiries) as mean_num_credit_inquiries\n    from source_ibm_prices\n    group by customer_id\n)\n\nselect * from final", "relation_name": "\"ada\".\"public\".\"bank_info_gold_res_avg\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.758839Z", "completed_at": "2024-04-24T22:59:17.772843Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.778838Z", "completed_at": "2024-04-24T22:59:17.778838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031000137329101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.bank_model.bank_info_silver", "compiled": true, "compiled_code": "\nwith source_ibm_prices as (\n    select * from \"ada\".\"public\".\"bank_info_bronze\"\n),\n\ncleaned_char as (\n    select  id\n            ,customer_id\n            ,REGEXP_REPLACE(num_of_delayed_payment, '[^0-9]', '', 'g') as num_of_delayed_payment\n            ,SPLIT_PART(credit_history_age, ' ', 1) as credit_history_age_years\n            ,SPLIT_PART(credit_history_age, ' ', 4) as credit_history_months\n            ,num_credit_inquiries\n            ,1 as cst_join\n    from source_ibm_prices\n),\n\npercentile as (\n    select percentile_cont(0.01) within group (order by num_credit_inquiries asc) as num_credit_inquiries_lb\n           ,percentile_cont(0.99) within group (order by num_credit_inquiries asc) as num_credit_inquiries_ub\n           ,1 as cst_join\n    from source_ibm_prices\n),\n\nresult_1 as (\n    select id\n           ,customer_id\n           ,coalesce(cast(num_of_delayed_payment as int), -1) as num_of_delayed_payment\n           ,cast(REGEXP_REPLACE(credit_history_age_years, '[^0-9]', '', 'g') as int) as credit_history_age_years\n           ,cast(REGEXP_REPLACE(credit_history_months, '[^0-9]', '', 'g') as int) as credit_history_months\n           ,num_credit_inquiries\n           ,num_credit_inquiries_lb\n           ,num_credit_inquiries_ub\n    from cleaned_char, percentile\n    where cleaned_char.cst_join = percentile.cst_join\n),\n\nfinal as (\n    select id\n           ,customer_id\n           ,num_of_delayed_payment\n           ,credit_history_age_years\n           ,credit_history_months\n           ,num_credit_inquiries\n           ,CASE\n                WHEN num_credit_inquiries < num_credit_inquiries_lb THEN num_credit_inquiries_lb\n                WHEN num_credit_inquiries > num_credit_inquiries_ub THEN num_credit_inquiries_ub\n                ELSE num_credit_inquiries\n            END new_num_credit_inquiries\n    from result_1\n)\n\nselect * from final", "relation_name": "\"ada\".\"public\".\"bank_info_silver\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.798838Z", "completed_at": "2024-04-24T22:59:17.825840Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.829837Z", "completed_at": "2024-04-24T22:59:17.829837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04099893569946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_bronze_customer_id.38ad4695a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ada\".\"public\".\"bank_info_bronze\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.843849Z", "completed_at": "2024-04-24T22:59:17.864841Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.871841Z", "completed_at": "2024-04-24T22:59:17.871841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03500080108642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_bronze_id.13abb64a69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"ada\".\"public\".\"bank_info_bronze\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.884841Z", "completed_at": "2024-04-24T22:59:17.897839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.902840Z", "completed_at": "2024-04-24T22:59:17.902840Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026006698608398438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.unique_bank_info_bronze_id.3a15868618", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"ada\".\"public\".\"bank_info_bronze\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.918839Z", "completed_at": "2024-04-24T22:59:17.936838Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:17.941839Z", "completed_at": "2024-04-24T22:59:17.941839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.032997846603393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.check_value_is_not_negative_bank_info_gold_last_id_last_credit_history_age_years.cd8fbc6fd2", "compiled": true, "compiled_code": "\nSELECT * FROM \"ada\".\"public\".\"bank_info_gold_last_id\" \n   WHERE last_credit_history_age_years < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:17.953838Z", "completed_at": "2024-04-24T22:59:17.996841Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.001837Z", "completed_at": "2024-04-24T22:59:18.001837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.055001020431518555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.dbt_expectations_expect_column_values_to_be_between_bank_info_gold_last_id_last_credit_history_age_years__50__0.a24413eb40", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and last_credit_history_age_years >= 0 and last_credit_history_age_years <= 50\n)\n as expression\n\n\n    from \"ada\".\"public\".\"bank_info_gold_last_id\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.017840Z", "completed_at": "2024-04-24T22:59:18.030839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.034839Z", "completed_at": "2024-04-24T22:59:18.034839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025002479553222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_gold_last_id_customer_id.de81b32be7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ada\".\"public\".\"bank_info_gold_last_id\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.048852Z", "completed_at": "2024-04-24T22:59:18.068838Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.072838Z", "completed_at": "2024-04-24T22:59:18.072838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03399991989135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_gold_last_id_last_credit_history_age_years.a8882e0ad5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect last_credit_history_age_years\nfrom \"ada\".\"public\".\"bank_info_gold_last_id\"\nwhere last_credit_history_age_years is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.085841Z", "completed_at": "2024-04-24T22:59:18.094838Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.098840Z", "completed_at": "2024-04-24T22:59:18.098840Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021001577377319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.unique_bank_info_gold_last_id_customer_id.f3246b26cd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ada\".\"public\".\"bank_info_gold_last_id\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.109842Z", "completed_at": "2024-04-24T22:59:18.135839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.140842Z", "completed_at": "2024-04-24T22:59:18.140842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.039000749588012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.check_value_is_not_negative_bank_info_gold_res_avg_mean_num_of_delayed_payment.f84a8765fd", "compiled": true, "compiled_code": "\nSELECT * FROM \"ada\".\"public\".\"bank_info_gold_res_avg\" \n   WHERE mean_num_of_delayed_payment < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.155838Z", "completed_at": "2024-04-24T22:59:18.167839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.170838Z", "completed_at": "2024-04-24T22:59:18.170838Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02400040626525879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.dbt_expectations_expect_column_values_to_be_between_bank_info_gold_res_avg_mean_num_of_delayed_payment__5000__0.1e14732073", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mean_num_of_delayed_payment >= 0 and mean_num_of_delayed_payment <= 5000\n)\n as expression\n\n\n    from \"ada\".\"public\".\"bank_info_gold_res_avg\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.184839Z", "completed_at": "2024-04-24T22:59:18.203840Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.208843Z", "completed_at": "2024-04-24T22:59:18.208843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.034000396728515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_gold_res_avg_customer_id.16ae66427e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"ada\".\"public\".\"bank_info_gold_res_avg\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.217838Z", "completed_at": "2024-04-24T22:59:18.229844Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.234841Z", "completed_at": "2024-04-24T22:59:18.234841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023003816604614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_gold_res_avg_mean_num_of_delayed_payment.cb233ffe39", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mean_num_of_delayed_payment\nfrom \"ada\".\"public\".\"bank_info_gold_res_avg\"\nwhere mean_num_of_delayed_payment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.247862Z", "completed_at": "2024-04-24T22:59:18.264839Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.269837Z", "completed_at": "2024-04-24T22:59:18.269837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03200387954711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.unique_bank_info_gold_res_avg_customer_id.a35f2dc548", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"ada\".\"public\".\"bank_info_gold_res_avg\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.281837Z", "completed_at": "2024-04-24T22:59:18.291837Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.295837Z", "completed_at": "2024-04-24T22:59:18.295837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018998146057128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.check_value_is_not_negative_bank_info_silver_num_of_delayed_payment.4b35174dfb", "compiled": true, "compiled_code": "\nSELECT * FROM \"ada\".\"public\".\"bank_info_silver\" \n   WHERE num_of_delayed_payment < 0\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.305840Z", "completed_at": "2024-04-24T22:59:18.338363Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.344362Z", "completed_at": "2024-04-24T22:59:18.344362Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04752659797668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.dbt_expectations_expect_column_values_to_be_between_bank_info_silver_num_of_delayed_payment__5000__0.d928f7f634", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and num_of_delayed_payment >= 0 and num_of_delayed_payment <= 5000\n)\n as expression\n\n\n    from \"ada\".\"public\".\"bank_info_silver\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.359363Z", "completed_at": "2024-04-24T22:59:18.372881Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.376880Z", "completed_at": "2024-04-24T22:59:18.376880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026521921157836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_silver_id.aa8a301ded", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"ada\".\"public\".\"bank_info_silver\"\nwhere id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.398882Z", "completed_at": "2024-04-24T22:59:18.414883Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.420884Z", "completed_at": "2024-04-24T22:59:18.420884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03599953651428223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.not_null_bank_info_silver_num_of_delayed_payment.fb4fdfded6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect num_of_delayed_payment\nfrom \"ada\".\"public\".\"bank_info_silver\"\nwhere num_of_delayed_payment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-24T22:59:18.434884Z", "completed_at": "2024-04-24T22:59:18.460884Z"}, {"name": "execute", "started_at": "2024-04-24T22:59:18.466895Z", "completed_at": "2024-04-24T22:59:18.466895Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0399932861328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.bank_model.unique_bank_info_silver_id.16d7598b3f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom \"ada\".\"public\".\"bank_info_silver\"\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 1.1870429515838623, "args": {"log_level": "info", "profiles_dir": "C:\\Users\\bruna\\.dbt", "log_path": "C:\\Users\\bruna\\dbt\\bank_model\\logs", "log_level_file": "debug", "select": [], "introspect": true, "static_parser": true, "quiet": false, "vars": {}, "show_resource_report": false, "use_colors_file": true, "static": false, "enable_legacy_logger": false, "which": "generate", "compile": true, "populate_cache": true, "printer_width": 80, "project_dir": "C:\\Users\\bruna\\dbt\\bank_model", "indirect_selection": "eager", "cache_selected_only": false, "defer": false, "log_format_file": "debug", "exclude": [], "use_colors": true, "strict_mode": false, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "print": true, "log_format": "default", "macro_debugging": false, "version_check": true, "write_json": true, "favor_state": false, "invocation_command": "dbt docs generate", "partial_parse_file_diff": true, "empty_catalog": false, "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}}}